// Google Maps script for Developer's Custom Fields
// Contributed by adriantoll
// Be careful of center (in this script) / centre (DCF form field IDs)
/*global google *//*global slt_cf_gmaps */// Set up an array for multiple maps
function slt_cf_gmap_init(e,t,n,r,i,s,o,u){var a,f,l,c,h,p,d,v;i=i.replace(" ","");a=i.split(",");i=new google.maps.LatLng(a[0],a[1]);o==="hybrid"?o=google.maps.MapTypeId.HYBRID:o==="satellite"?o=google.maps.MapTypeId.SATELLITE:o==="terrain"?o=google.maps.MapTypeId.TERRAIN:o=google.maps.MapTypeId.ROADMAP;f={zoom:s,center:i,mapTypeId:o,scrollwheel:!1};slt_cf_maps[e]=[];slt_cf_maps[e].map=new google.maps.Map(document.getElementById(e),f);slt_cf_maps[e].map._slt_cf_mapname=e;if(n){var m=t==="input"?!0:!1;l=r.split(",");r=new google.maps.LatLng(l[0],l[1]);slt_cf_maps[e].marker=new google.maps.Marker({map:slt_cf_maps[e].map,position:r,draggable:m,animation:google.maps.Animation.DROP});slt_cf_maps[e].marker._slt_cf_mapname=e;google.maps.event.addListener(slt_cf_maps[e].marker,"drag",function(){var e=this.getPosition().toString().slice(1,-1).replace(" ","");document.getElementById(this._slt_cf_mapname+"_marker_latlng").value=e})}if(t==="input"){google.maps.event.addListener(slt_cf_maps[e].map,"bounds_changed",function(){document.getElementById(this._slt_cf_mapname+"_zoom").value=this.getZoom();document.getElementById(this._slt_cf_mapname+"_centre_latlng").value=this.getCenter().toString().slice(1,-1).replace(" ","");document.getElementById(this._slt_cf_mapname+"_bounds_sw").value=this.getBounds().getSouthWest().toString().slice(1,-1).replace(" ","");document.getElementById(this._slt_cf_mapname+"_bounds_ne").value=this.getBounds().getNorthEast().toString().slice(1,-1).replace(" ","")});if(jQuery().autocomplete){c=new google.maps.Geocoder;h=jQuery("#"+e+"_bounds_sw").val().split(",");d=jQuery("#"+e+"_bounds_ne").val().split(",");p=new google.maps.LatLng(h[0],h[1]);v=new google.maps.LatLng(d[0],d[1]);slt_cf_maps[e].map.geocodeBounds=new google.maps.LatLngBounds(p,v);jQuery(document).ready(function(t){t("#"+e).after('<p class="gmap-address"><label for="'+e+'_address">'+slt_cf_gmaps.geocoder_label+':</label> <input type="text" id="'+e+'_address" name="'+e+'_address" value="" class="regular-text" /></p>');t("#"+e+"_address").autocomplete({source:function(n,r){c.geocode({address:n.term,bounds:slt_cf_maps[e].map.getBounds()},function(e,n){n==google.maps.GeocoderStatus.OK?r(t.map(e,function(e){return{label:e.formatted_address,value:e.formatted_address,latitude:e.geometry.location.lat(),longitude:e.geometry.location.lng()}})):console.log("Geocode was not successful for the following reason: "+n)})},select:function(r,i){n&&t("#"+e+"_marker_latlng").val(i.item.latitude+","+i.item.longitude);t("#"+e+"_centre_latlng").val(i.item.latitude+","+i.item.longitude);var s=new google.maps.LatLng(i.item.latitude,i.item.longitude);n&&slt_cf_maps[e].marker.setPosition(s);slt_cf_maps[e].map.panTo(s)}})})}}typeof u!="undefined"&&window[u]&&window[u](slt_cf_maps[e].map)}var slt_cf_maps=[];jQuery(document).ready(function(e){e("div.gmap_input").length&&e("div.gmap_input").each(function(){var t,n;t=e(this).attr("id");e("input.gmap_toggle_display").length&&e("input.gmap_toggle_display").change(function(){e(this).hasClass("yes")?e("#"+t+"_wrapper").slideDown("fast",function(){n=slt_cf_maps[t].map.getCenter();google.maps.event.trigger(slt_cf_maps[t].map,"resize");slt_cf_maps[t].map.setCenter(n)}):e("#"+t+"_wrapper").slideUp()})})});